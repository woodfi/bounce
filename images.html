<!DOCTYPE html>
<html>

<head>

<title> Bounce | Images</title>
<link href="https://unpkg.com/tailwindcss@^1.0/dist/tailwind.min.css" rel="stylesheet">
<meta author="Arav narula"> 
<meta desc="A Dead Simple Ideas Genrator">

<!-- Scripts, Styles, and Layouts-->
<script>
(function($) {
    $.fn.unsplash = function(options) {
        //Default values
        var defaults = {
            client_id: 'VQxweJWOjpK3xKhhreETX4pdY_z_p_KpbDMfVVzR7qs',
            limit: '100',
            columns: '100',
            width: '56'
        };
        var settings = $.extend({}, defaults, options);
        
        //Set default parameters
        var page = $(".more").attr("href") ? undefined : 1;
        var filter = $(".dropdown a").attr("href") ? undefined : 'laltest';

        //Initialize Masonry
        var $container = $('#unsplash');
        $container.imagesLoaded(function() {
            $container.masonry({
                itemSelector: '.item'
            });
        });
        function unsplash(page, filter) {
            $.ajax({
                url: 'https://api.unsplash.com/photos',
                type: 'GET',
                dataType: 'json',
                data: {
                    client_id: settings.client_id,
                    page: page,
                    per_page: settings.limit,
                    order_by: filter
                },
                success: function(data) {
                    $.each(data, function(i, item) {
                        var containerWidth = $(".container").width();
                        //Aspect Ratio
                        var width = item.width;
                        var height = item.height;
                        var item_width = $(".item").width();
                        var new_height = Math.round((height / width) * containerWidth/settings.columns);
                        //Set custom width
                        var image_url = item.urls.small.replace("&w=400", "&w=" + settings.width);
                        var image = $("<img>").attr("src", image_url).hide();
                        image.fadeToggle("slow");
                        var link = $("<a class='link' target='_blank'>").attr("href", item.links.html).append(image).css({"height": new_height, "background-color":item.color});
                        var name = $("<p>").append("By ", item.user.name);
                        var item = $("<div class='item'>").append(link, name).css({"width": containerWidth/settings.columns});
                        var $container = $('#unsplash');
                        //Append item to Masonry
                        var $item = $(item);
                        $container.append( $item ).masonry().masonry( 'appended', $item );
                    });
                    //Set page number value in MORE button
                    var more = $("<a class='more'>").attr("href", page).html("<span>...</span>");
                    $("#more").html(more);
                }, 
                error: function(){
                    $(".more").html("ERROR");
                }
            });
        }

        //Click function to get the next page
        $(document).on('click', '.more', function() {
            page = $(".more").attr('href');
            page++;
            unsplash(page, filter);
            return false;
        });
        $(document).on('click', '.dropdown a', function(e) {
            e.preventDefault();
            $("#unsplash").masonry( 'destroy' );
            $("#unsplash,#more").empty();
            filter = $(this).attr("href");
            unsplash(1, filter);
        });
        //Initial Load
        unsplash(page, filter);
        
        $( document ).ajaxComplete(function( event, xhr, settings,XMLHttpRequest ) {
            setTimeout(function() {
                if(xhr.status == 200){
                     $(".more").html("MORE");
                } else {
                    $(".more").html("ERROR");
                }
            }, 1500);
        });
    };
}(jQuery));

</script>

<!--- HomeBrewed Scripts and Styles/Layouts-->
<link rel="stylesheet" href="style.css">

</head>

<div class="top">
    <ul>
      <li><a class="logo" href="#"><i class="fa fa-camera"></i>Unsplash <strong>API</strong></a></li>
    </ul>
  </div>
  <div class="message_holder">
    <div class="message">
      <span>Unsplash: Free (do whatever you want) high-resolution photos.</span>
      <div class="dropdown">
        <button class="dropbtn">FILTER BY</button>
        <div class="dropdown-content">
          <a href="latest">Latest</a>
          <a href="popular">Popular</a>
          <a href="oldest">Oldest</a>
        </div>
      </div>
    </div>
  </div>
  <div class="container" >
    <div id="unsplash" >
    </div>
    <div id="more">
      <a class="more"><span>...</span></a>
      </div> 
  </div>
</body>
<script src='js/jquery.min.js'></script>
<script src='js/jquery.masonry.js'></script>
<script src='js/imagesloaded.pkgd.js'></script>
<script src="js/api.js"></script>
<script>
 
</script>
</body>